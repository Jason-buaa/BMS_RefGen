/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={58394:function(t,e,n){t.exports=n.p+"1fda685b81e1123773f6.css"}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var c=e[o]={exports:{}};return t[o](c,c.exports,n),c.exports}n.m=t,n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");if(o.length)for(var r=o.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=o[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b=document.baseURI||self.location.href,function(){function t(){var n,o,r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function i(t,r,c,a){var i=r&&r.prototype instanceof s?r:s,l=Object.create(i.prototype);return e(l,"_invoke",function(t,e,r){var c,a,i,s=0,l=r||[],f=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(t,e){return c=t,a=0,i=n,p.n=e,u}};function d(t,e){for(a=t,i=e,o=0;!f&&s&&!r&&o<l.length;o++){var r,c=l[o],d=p.p,b=c[2];t>3?(r=b===e)&&(a=c[4]||3,i=c[5]===n?c[3]:c[5],c[4]=3,c[5]=n):c[0]<=d&&((r=t<2&&d<c[1])?(a=0,p.v=e,p.n=c[1]):d<b&&(r=t<3||c[0]>e||e>b)&&(c[4]=t,c[5]=e,p.n=b,a=0))}if(r||t>1)return u;throw f=!0,e}return function(r,l,b){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,b),a=l,i=b;(o=a<2?n:i)||!f;){c||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(s=2,c){if(a||(r="next"),o=c[r]){if(!(o=o.call(c,i)))throw TypeError("iterator result is not an object");if(!o.done)return o;i=o.value,a<2&&(a=0)}else 1===a&&(o=c.return)&&o.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+r+"' method"),a=1);c=n}else if((o=(f=p.n<0)?i:t.call(e,p))!==u)break}catch(t){c=n,a=1,i=t}finally{s=1}}return{value:o,done:f}}}(t,c,a),!0),l}var u={};function s(){}function l(){}function f(){}o=Object.getPrototypeOf;var p=[][c]?o(o([][c]())):(e(o={},c,(function(){return this})),o),d=f.prototype=s.prototype=Object.create(p);function b(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,f):(t.__proto__=f,e(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return l.prototype=f,e(d,"constructor",f),e(f,"constructor",l),l.displayName="GeneratorFunction",e(f,a,"GeneratorFunction"),e(d),e(d,a,"Generator"),e(d,c,(function(){return this})),e(d,"toString",(function(){return"[object Generator]"})),(t=function(){return{w:i,m:b}})()}function e(t,n,o,r){var c=Object.defineProperty;try{c({},"",{})}catch(t){c=0}e=function(t,n,o,r){if(n)c?c(t,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):t[n]=o;else{var a=function(n,o){e(t,n,(function(t){return this._invoke(n,o,t)}))};a("next",0),a("throw",1),a("return",2)}},e(t,n,o,r)}function n(t,e,n,o,r,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(o,r)}function o(t){return function(){var e=this,o=arguments;return new Promise((function(r,c){var a=t.apply(e,o);function i(t){n(a,r,c,i,u,"next",t)}function u(t){n(a,r,c,i,u,"throw",t)}i(void 0)}))}}function r(){return c.apply(this,arguments)}function c(){return c=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var o,r,c,i,u,s,l;return t().w((function(t){for(;;)switch(t.n){case 0:r=0,c=o=["BMS1_CalibGen","BMS2_CalibGen"];case 1:if(!(r<c.length)){t.n=7;break}return i=c[r],u=n.workbook.worksheets.getItemOrNullObject(i),t.n=2,n.sync();case 2:if(u.isNullObject){t.n=5;break}return t.n=3,a('The sheet "'.concat(i,'" already exists. Do you want to overwrite it?'));case 3:if("yes"!==t.v){t.n=4;break}u.delete(),t.n=5;break;case 4:return console.log('Skipped creating sheet "'.concat(i,'".')),t.a(3,6);case 5:s=n.workbook.worksheets.add(i),l=void 0,"BMS1_CalibGen"===i?(l=[["Name","Value","Note"],["TuneCAD_CCP","Enable","Set to Enable so TuneCAD can be used for calibration activities."],["Calibration Ref(F182)","A322","Cxx_calib_nr"],["Soft(F194)","CL01","Ctx_sw_name"],["VPROG(F195)","9110","To be modified by E2CAD,Ctx_sw_version"],["REF SW(Ref. Logiciel RSA)F012","293861621R","Ctx_refC,Ctx_RUC"],["REF C ($F187)","293A03498R","Ctx_c_id1-Ctx_c_id16"],["Diag. Version\n(F1A0)","06","Cxx_Vdiag"],["Ref homologation F196","HMLGT0434R","Ctx_ObdApproval,Cxx_obd_cert_nr1 -Cxx_obd_cert_nr10"],["BECM-B+EnergyCtrl","EqualForAllProject","Cxx_obd_ecu_name_1 to Cxx_obd_ecu_name_20"]],s.getRange("A1:C10").values=l):"BMS2_CalibGen"===i&&(l=[["Name","Value","Note"],["Calibration Ref(F182)","A422","Cxx_calib_nr"],["Soft(F194)","CL01","Ctx_sw_name"],["VPROG(F195)","9110","To be modified by E2CAD,Ctx_sw_version"],["REF SW(Ref. Logiciel RSA)F012","293861621R","Ctx_refC,Ctx_RUC"],["Ref A ($F191)","293A09147R","Ctx_refA"]],s.getRange("A1:C6").values=l),s.getUsedRange().format.autofitColumns(),s.getUsedRange().format.autofitRows();case 6:r++,t.n=1;break;case 7:return n.workbook.worksheets.getItem(o[0]).activate(),t.n=8,n.sync();case 8:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error(n);case 3:return e.a(2)}}),e,null,[[0,2]])}))),c.apply(this,arguments)}function a(t){return new Promise((function(e){var n=document.getElementById("taskpane-message-container");n.innerHTML="\n      <p>".concat(t,'</p>\n      <button id="overwrite-yes" class="ms-Button">Yes</button>\n      <button id="overwrite-no" class="ms-Button">No</button>\n    '),document.getElementById("overwrite-yes").onclick=function(){i(n),e("yes")},document.getElementById("overwrite-no").onclick=function(){i(n),e("no")}}))}function i(t){t.style.transition="opacity 0.5s ease",t.style.opacity="0",setTimeout((function(){t.innerHTML="",t.style.opacity="1"}),500)}function u(){return s.apply(this,arguments)}function s(){return s=o(t().m((function e(){var n;return t().w((function(e){for(;;)switch(e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=o(t().m((function e(n){var o,r,c,a,i,u,s,f,p,d,b,h,C,_,m,g,y,v,x,R,w,S,F,A,k,E,O,j,B,T;return t().w((function(t){for(;;)switch(t.n){case 0:return(o=n.workbook.worksheets.getActiveWorksheet()).load("name"),t.n=1,n.sync();case 1:return r=o.name,console.log("Active sheet name: ".concat(r)),(c=o.getUsedRange()).load("values"),t.n=2,n.sync();case 2:if(a=c.values,i=[],"BMS1_CalibGen"!==r){t.n=3;break}for(u=1;u<a.length;u++)if(a[u][0],s=null!=(s=a[u][1])?s.toString():"",1===u)f="Enable"===s?"Cbx_ccp_ena =1;":"Cbx_ccp_ena =0;",i.push(f);else if(2===u)i.push("Cxx_calib_nr= hex2dec('".concat(s,"');"));else if(3===u)p=s.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("Ctx_sw_name=[".concat(p,"];% NPROG (F194 = ").concat(s,")"));else if(4===u)d=s.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("%Ctx_sw_version=[".concat(d,"]; %VPROG (F195 =").concat(s,"), Not in A2L"));else if(5===u)b=s.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("Ctx_refC=[".concat(b,"]; %REF SW(Ref. Logiciel RSA) F012 = F188 = ").concat(s)),i.push("Ctx_RUC =[".concat(b,"]; %REF SW(Ref. Logiciel RSA) F012 = F188 = ").concat(s));else if(6===u)for(h=s.split("").map((function(t){return t.charCodeAt(0)})),C=0;C<16;C++)_=h[C]||0,i.push("Ctx_c_id".concat(C+1,"   =   ").concat(_,"   ;% REF C ($F187) = ").concat(s));else if(7===u)i.push("Cxx_Vdiag = ".concat(parseInt(s,16),";%Diag. Version (F1A0) is ").concat(s,"."));else if(8===u)for(m=s.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("Ctx_ObdApproval = [".concat(m,"]; %Ref homologation F196 = ").concat(s)),g=s.split("").map((function(t){return t.charCodeAt(0)})),y=0;y<10;y++)v=g[y]||0,i.push("Cxx_obd_cert_nr".concat(y+1,"    =   ").concat(v,"   ;%Ref homologation F196 = ").concat(s));else if(9===u)for(x=[66,69,67,77,45,66,43,69,110,101,114,103,121,67,116,114,108,0,0,0],R=0;R<x.length;R++)i.push("Cxx_obd_ecu_name_".concat(R+1,"  = ").concat(x[R],"; % BECM-B+EnergyCtrl"));t.n=5;break;case 3:if("BMS2_CalibGen"!==r){t.n=4;break}for(w=1;w<a.length;w++)a[w][0],S=null!=(S=a[w][1])?S.toString():"",1===w?i.push("Cxx_calib_nr= hex2dec('".concat(S,"');%Calibration Ref(F182)")):2===w?(F=S.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("Ctx_sw_name=[".concat(F,"];% NPROG (F194 = ").concat(S,")"))):3===w?(A=S.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("%Ctx_sw_version=[".concat(A,"]; %VPROG (F195 =").concat(S,"),not in A2L."))):4===w?(k=S.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("Ctx_refC=[".concat(k,"]; %F012 = ").concat(S,"  Ref envoyé par Raoul DROUSSE")),i.push("Ctx_RUC =[".concat(k,"]; %F012 = ").concat(S,"  Ref envoyé par Raoul DROUSSE"))):5===w&&(E=S.split("").map((function(t){return t.charCodeAt(0)})).join(" "),i.push("Ctx_refA    =   [".concat(E,"];%Réf A ($F191)= ").concat(S)));t.n=5;break;case 4:return console.error("Unsupported sheet name: ".concat(r)),t.a(2);case 5:O=i.join("\n"),j=new Date,B="".concat(j.getFullYear()).concat(String(j.getMonth()+1).padStart(2,"0")).concat(String(j.getDate()).padStart(2,"0"),"_").concat(String(j.getHours()).padStart(2,"0")).concat(String(j.getMinutes()).padStart(2,"0")).concat(String(j.getSeconds()).padStart(2,"0")),T="".concat(r,"Ref_").concat(B,".m"),l(O,T);case 6:return t.a(2)}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error exporting modified values:",n);case 3:return e.a(2)}}),e,null,[[0,2]])}))),s.apply(this,arguments)}function l(t,e){var n=new Blob([t],{type:"text/plain"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download=e,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(o)}Office.onReady((function(t){t.host===Office.HostType.Excel&&(document.getElementById("app-body").style.display="flex",document.getElementById("create-template").onclick=r,document.getElementById("export-values").onclick=u)}))}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map